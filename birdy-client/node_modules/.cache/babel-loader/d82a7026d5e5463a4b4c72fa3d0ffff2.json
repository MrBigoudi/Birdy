{"ast":null,"code":"import _asyncToGenerator from\"/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from\"react\";import{Link,useNavigate}from\"react-router-dom\";import*as ROUTES from\"../../constants/routes.js\";import SearchBar from\"./SearchBar.js\";import\"../../stylesheets/components/sideBar.css\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SideBar(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),follows=_useState2[0],setFollows=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),followed=_useState4[0],setFollowed=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),userCurPage=_useState6[0],setUserCurPage=_useState6[1];var navigate=useNavigate();useEffect(function(){function initFollows(){return _initFollows.apply(this,arguments);}function _initFollows(){_initFollows=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!props.logged){_context.next=9;break;}setUserCurPage(props.user);_context.next=4;return axios.get(\"/api/user/\".concat(props.user,\"/follows\")).then(function(res){//console.log('res.data: ', res.data);\nsetFollows(res.data);});case 4:if(!props.connectedUser){_context.next=7;break;}_context.next=7;return axios.get(\"/api/user/\".concat(props.connectedUser)).then(function(res){setFollowed(res.data['following'].includes(props.user));});case 7:_context.next=10;break;case 9:setFollows([]);case 10:case\"end\":return _context.stop();}}},_callee);}));return _initFollows.apply(this,arguments);}initFollows();},[props.logged,props.user,props.connectedUser]);var listFollows=function listFollows(){var listUsernameFollows=follows.map(function(user){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"h4\",{className:\"follow-list-username\",onClick:function onClick(event){return handleCheckUserPage(event,user['_id']);},children:user['username']})},user['_id']);});return/*#__PURE__*/_jsx(\"div\",{className:\"follow-list-handler\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"follow-list\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"follow-list-title\",children:'Follows list'}),/*#__PURE__*/_jsx(\"ul\",{className:\"follow-list-elem\",children:listUsernameFollows})]})});};var handleClickFollowButton=function handleClickFollowButton(){//console.log('userCurPage: ', { followId: userCurPage });\nif(!followed){axios.post(\"/api/user/\".concat(props.connectedUser,\"/follows\"),{followId:userCurPage}).then(function(){setFollowed(function(prev){return!prev;});});}else{axios.delete(\"/api/user/\".concat(props.connectedUser,\"/follows/\").concat(props.user)).then(function(){setFollowed(function(prev){return!prev;});});}};function handleCheckUserPage(_x,_x2){return _handleCheckUserPage.apply(this,arguments);}function _handleCheckUserPage(){_handleCheckUserPage=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event,userId){var loggedUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();loggedUser=userCurPage;//console.log('test handle check user page');\nif(loggedUser!==userId){navigate(\"/p/\".concat(loggedUser),{state:{alreadyLogged:true,userId:userId},replace:false});}case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _handleCheckUserPage.apply(this,arguments);}var followButton=function followButton(){return/*#__PURE__*/_jsx(\"div\",{className:\"follow-button-handler\",children:/*#__PURE__*/_jsx(\"div\",{className:\"follow-button\",onClick:handleClickFollowButton,children:followed?\"Unfollow\":\"Follow\"})});};return/*#__PURE__*/_jsxs(\"section\",{className:\"side-bar\",children:[/*#__PURE__*/_jsx(SearchBar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"side-bar-connections\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"link-handler\",children:/*#__PURE__*/_jsx(Link,{className:\"link-route link-no-style link-blue\",to:props.logged?ROUTES.DASHBOARD:ROUTES.LOGIN,children:props.logged?\"Log Out\":\"Log In\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"link-handler\",children:/*#__PURE__*/_jsx(Link,{className:\"link-route link-no-style link-blue\",to:ROUTES.SIGN_UP,children:\"Sign Up\"})})]}),props.connectedUser&&props.connectedUser!==props.user?followButton():'',props.logged?listFollows():'']});}","map":{"version":3,"sources":["/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/src/components/SideBar/SideBar.js"],"names":["React","useState","useEffect","Link","useNavigate","ROUTES","SearchBar","axios","SideBar","props","follows","setFollows","followed","setFollowed","userCurPage","setUserCurPage","navigate","initFollows","logged","user","get","then","res","data","connectedUser","includes","listFollows","listUsernameFollows","map","event","handleCheckUserPage","handleClickFollowButton","post","followId","prev","delete","userId","preventDefault","loggedUser","state","alreadyLogged","replace","followButton","DASHBOARD","LOGIN","SIGN_UP"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport * as ROUTES from \"../../constants/routes.js\";\n\nimport SearchBar from \"./SearchBar.js\";\n\nimport \"../../stylesheets/components/sideBar.css\"\nimport axios from \"axios\";\n\nexport default function SideBar(props){\n    const [follows, setFollows ] = useState([]);\n    const [followed, setFollowed] = useState(false);\n    const [userCurPage, setUserCurPage] = useState();\n    const navigate = useNavigate();\n\n    useEffect( () => {\n            async function initFollows() {\n                if(props.logged){\n                    setUserCurPage(props.user)\n                    await axios\n                        .get(`/api/user/${props.user}/follows`)\n                        .then( (res) => {\n                            //console.log('res.data: ', res.data);\n                            setFollows(res.data);\n                        })\n                    if(props.connectedUser){\n                        await axios\n                            .get(`/api/user/${props.connectedUser}`)\n                            .then( (res) => {\n                                setFollowed(res.data['following'].includes(props.user))\n                            })\n                    }\n                } else {\n                    setFollows([]);\n                }\n            }\n\n            initFollows();\n\n        },[props.logged, props.user, props.connectedUser]\n    );\n\n    const listFollows = () => {\n        const listUsernameFollows = follows.map( (user) => {\n            return (\n                <li key={user['_id']}>\n                    <h4 className=\"follow-list-username\" onClick={(event) => handleCheckUserPage(event,user['_id'])}>\n                        {user['username']}\n                    </h4>\n                </li>\n            );\n        });\n\n        return (\n            <div className=\"follow-list-handler\">\n                <div className=\"follow-list\">\n                    <h2 className=\"follow-list-title\">{'Follows list'}</h2>\n                    <ul className=\"follow-list-elem\">{listUsernameFollows}</ul>\n                </div>\n            </div>\n        )        \n    }\n\n    const handleClickFollowButton = () => {\n        //console.log('userCurPage: ', { followId: userCurPage });\n        if(!followed){\n            axios\n                .post(`/api/user/${props.connectedUser}/follows`, { followId: userCurPage })\n                .then( () => {\n                    setFollowed(prev => {return !prev});\n                })\n        } else {\n            axios\n                .delete(`/api/user/${props.connectedUser}/follows/${props.user}`)\n                .then( () => {\n                    setFollowed(prev => {return !prev});\n                })\n        }\n    }\n\n    async function handleCheckUserPage(event, userId){\n        event.preventDefault();\n        const loggedUser = userCurPage;\n        //console.log('test handle check user page');\n        if(loggedUser!==userId){\n            navigate(`/p/${loggedUser}`, { state: { alreadyLogged: true, userId: userId }, replace: false, });\n        }\n    }\n\n    const followButton = () => {\n        return (\n            <div className=\"follow-button-handler\">\n                <div className=\"follow-button\" onClick={handleClickFollowButton}>\n                    {followed ? \"Unfollow\" : \"Follow\"}\n                </div>\n            </div>\n        );\n    }\n\n    return(\n        <section className=\"side-bar\">\n            <SearchBar />\n            <div className=\"side-bar-connections\">\n                <div className=\"link-handler\">\n                    <Link className=\"link-route link-no-style link-blue\" to={props.logged ? ROUTES.DASHBOARD : ROUTES.LOGIN} >\n                        {props.logged ? \"Log Out\" : \"Log In\"}\n                    </Link>\n                </div>\n                <div className=\"link-handler\">\n                    <Link className=\"link-route link-no-style link-blue\" to={ROUTES.SIGN_UP}>\n                        Sign Up\n                    </Link> \n                </div>\n            </div>\n            {(props.connectedUser && props.connectedUser!==props.user)? followButton() : ''}\n            {props.logged? listFollows() : ''}\n        </section>\n    )\n}"]},"metadata":{},"sourceType":"module"}