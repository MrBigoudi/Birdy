{"ast":null,"code":"import _asyncToGenerator from\"/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from\"react\";import{Link,useNavigate}from\"react-router-dom\";import axios from\"axios\";import*as ROUTES from\"../constants/routes.js\";// import * as ERROR_MSG from \"../constants/errorMessages.js\";\nimport BirdyLogo from\"../atomComponents/Birdy-logo.js\";import\"../stylesheets/form.css\";// import { checkLogin } from \"../database/users.js\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Login(){var navigate=useNavigate();var _useState=useState({emailAddress:\"\",passwd:\"\"}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var isInvalid=formData.passwd===\"\"||formData.emailAddress===\"\";useEffect(function(){document.title=\"Login - Birdy\";},[]);function handleChange(event){setFormData(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},event.target.name,event.target.value));});};var answer_login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){var _id;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://console.log('res.data: ', res.data);\nif(res.data['status']!==200){setError(res.data['message']);console.log('error: ',error);}else{_id=res.data['id'];//console.log('user_id: ', _id);\nnavigate(\"/p/\".concat(_id),{state:{},replace:true});}case 1:case\"end\":return _context.stop();}}},_callee);}));return function answer_login(_x){return _ref.apply(this,arguments);};}();var answer_login_err=function answer_login_err(err){if(err.response){// The request was made and the server responded with a status code\n// that falls out of the range of 2xx\nconsole.log('err.response.data: ',err.response.data);console.log('err.response.status: ',err.response.status);console.log('err.response.headers: ',err.response.headers);setError(err.response.data['message']);if(err.response.status===403){setFormData(function(prev){return _objectSpread(_objectSpread({},prev),{},{passwd:\"\"});});}}else if(err.request){// The request was made but no response was received\n// `error.request` is an instance of XMLHttpRequest in the browser and an instance of\n// http.ClientRequest in node.js\nconsole.log(err.request);}else{// Something happened in setting up the request that triggered an Error\nconsole.log('Error',err.message);}console.log(err.config);};var handleLogin=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();axios.post(\"/api/user/login\",formData).then(function(res){//console.log('then');\nanswer_login(res);}).catch(function(err){//console.log('catch');\nanswer_login_err(err);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function handleLogin(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"main\",{className:\"form-page-main column gap20\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-container column gap20\",children:[/*#__PURE__*/_jsx(BirdyLogo,{}),/*#__PURE__*/_jsxs(\"form\",{className:\"base-form column\",onSubmit:handleLogin,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-input\",type:\"email\",placeholder:\"Email address\",\"aria-label\":\"Enter your email address\",onChange:handleChange,name:\"emailAddress\",value:formData.emailAddress}),/*#__PURE__*/_jsx(\"input\",{className:\"form-input\",type:\"password\",placeholder:\"Password\",\"aria-label\":\"Enter your password\",onChange:handleChange,name:\"passwd\",value:formData.passwd}),/*#__PURE__*/_jsx(\"input\",{className:\"form-submit \".concat(isInvalid&&\"submit-invalid\"||\"submit\"),type:\"submit\",value:\"Log In\",disabled:isInvalid})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message form-error\",children:error})]}),/*#__PURE__*/_jsx(\"div\",{className:\"base-form-footer\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Don't have an account?\\u2002\",/*#__PURE__*/_jsx(Link,{className:\"link-route\",to:ROUTES.SIGN_UP,children:\"Sign up\"})]})})]});};","map":{"version":3,"sources":["/home/mrbigoudi/Documents/Projects/Birdy/birdy-client/src/pages/Login.js"],"names":["React","useState","useEffect","Link","useNavigate","axios","ROUTES","BirdyLogo","Login","navigate","emailAddress","passwd","formData","setFormData","error","setError","isInvalid","document","title","handleChange","event","prev","target","name","value","answer_login","res","data","console","log","_id","state","replace","answer_login_err","err","response","status","headers","request","message","config","handleLogin","preventDefault","post","then","catch","SIGN_UP"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\n\nimport * as ROUTES from \"../constants/routes.js\";\n// import * as ERROR_MSG from \"../constants/errorMessages.js\";\n\nimport BirdyLogo from \"../atomComponents/Birdy-logo.js\";\nimport \"../stylesheets/form.css\";\n\n// import { checkLogin } from \"../database/users.js\";\n\nexport default function Login(){\n\n    const navigate = useNavigate();\n\n    const [formData, setFormData] = useState(\n        {emailAddress:\"\", passwd:\"\"}\n    );\n\n    const [error, setError] = useState(\"\");\n\n    const isInvalid = formData.passwd === \"\" || formData.emailAddress === \"\";\n\n    useEffect( () => {\n        document.title = \"Login - Birdy\";\n    }, []);\n\n    function handleChange(event){\n        setFormData( prev => {\n            return {\n                ...prev,\n                [event.target.name]: event.target.value\n            }\n        })\n    };\n\n    const answer_login = async (res) => {\n        //console.log('res.data: ', res.data);\n        if(res.data['status'] !== 200){\n            setError(res.data['message']);\n            console.log('error: ', error);\n        }else{\n            const _id = res.data['id'];\n            //console.log('user_id: ', _id);\n            navigate(`/p/${_id}`, { state: {}, replace: true, });\n        }\n    }\n\n    const answer_login_err = (err) => {\n        if (err.response) {\n            // The request was made and the server responded with a status code\n            // that falls out of the range of 2xx\n            console.log('err.response.data: ',    err.response.data);\n            console.log('err.response.status: ',  err.response.status);\n            console.log('err.response.headers: ', err.response.headers);\n            setError(err.response.data['message']);\n            if(err.response.status === 403){\n                setFormData( prev => {return {...prev, passwd:\"\"}});\n            }\n        } else if (err.request) {\n            // The request was made but no response was received\n            // `error.request` is an instance of XMLHttpRequest in the browser and an instance of\n            // http.ClientRequest in node.js\n            console.log(err.request);\n        } else {\n            // Something happened in setting up the request that triggered an Error\n            console.log('Error', err.message);\n        }\n        \n        console.log(err.config);\n    }\n\n    const handleLogin = async (event) => {\n        event.preventDefault();\n        axios\n            .post(\"/api/user/login\", formData)\n            .then( (res) => {\n                //console.log('then');\n                answer_login(res);\n            })\n            .catch( (err) => {\n                //console.log('catch');\n                answer_login_err(err);\n            });\n    }\n\n    return(\n        <main className=\"form-page-main column gap20\">\n            <div className=\"form-container column gap20\">\n                <BirdyLogo />\n                <form className=\"base-form column\" onSubmit={handleLogin}>\n                    <input\n                        className=\"form-input\" \n                        type=\"email\" \n                        placeholder=\"Email address\" \n                        aria-label=\"Enter your email address\"\n                        onChange={handleChange}\n                        name=\"emailAddress\"\n                        value={formData.emailAddress}\n                    />\n                    <input\n                        className=\"form-input\" \n                        type=\"password\" \n                        placeholder=\"Password\" \n                        aria-label=\"Enter your password\"\n                        onChange={handleChange}\n                        name=\"passwd\"\n                        value={formData.passwd}                        \n                    />\n                    <input \n                        className={`form-submit ${(isInvalid && \"submit-invalid\") || \"submit\"}`}\n                        type=\"submit\" \n                        value=\"Log In\"\n                        disabled={isInvalid}\n                    />\n                </form>\n                {error && <p className=\"error-message form-error\">{error}</p>}\n            </div>\n            <div className=\"base-form-footer\">\n                <p>\n                    Don't have an account?&ensp;\n                    <Link className=\"link-route\" to={ROUTES.SIGN_UP}>\n                        Sign up\n                    </Link>\n                </p>\n            </div>\n        </main>\n    )\n};"]},"metadata":{},"sourceType":"module"}